{% load staticfiles %}
<html class="no-js">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <meta name="keywords" content=""/>
    <meta name="description" content="phith0n的小站，长期存在与分享关于网络安全与各种编程的原创文章。"/>
    <title>首页 | 离别歌</title>
    <link rel="alternate" type="application/atom+xml" href="/feed/" title="离别歌"/>
    <link href="{% static 'home/css/base_1.css' %}" rel="stylesheet" type="text/css"/>
    <link href="{% static 'home/css/style_1.css' %}" rel="stylesheet" type="text/css"/>
    <script src="{% static 'home/js/jquery-1.9.1.min_1.js' %}"></script>
    <script src="{% static 'home/js/common_tpl_1.js' %}" type="text/javascript"></script>
    <link rel="shortcut icon" href="/static/deep/images/favicon.ico"/>

</head>
<body>
<!--[if lt IE 8]>
    <div class="browsehappy" role="dialog">当前网页 <strong>不支持</strong> 你正在使用的浏览器. 为了正常的访问, 请 <a href="http://browsehappy.com/">升级你的浏览器</a>.</div>
<![endif]-->
<div id="header">
    <div class="container">
        <h1 class="h1-title">
            <a href="/">
                <img src="{% static 'upload/images/logo_1.png'%}" alt="离别歌"/>
            </a>
        </h1>
        <div id="nav">
            <input type="checkbox" id="button">
            <label for="button" onclick>菜单</label>

            <ul>

                <li class="item ">
                    <a href="/">首页</a>
                </li>

                <li class="item ">
                    <a href="/list/">文章</a>
                </li>

                <li class="item ">
                    <a href="/other/tinger.html">关于</a>
                </li>

                <li class="item ">
                    <a href="/other/friends-link.html">友链</a>
                </li>

                <li class="item ">
                    <a href="https://github.com/phith0n" target="_blank">项目</a>
                </li>

                <li class="item ">
                    <a href="https://www.leavesongs.com/PENETRATION/code-auditor-secret-group.html"
                       target="_blank">代码审计</a>
                </li>

            </ul>

        </div>
    </div>
</div>

<div class="slider">
    <div class="banner-overlay"></div>
    <div class="container">
        <div class="row">
            <div class="col-10 columns">
                <div class="hero">
                    <h2>离别歌</h2>
                    <p id="blog_info">The quieter you become,the more you are able to hear.</p>
                    <mark class="mark">Programming • Vulnerability • Bypass • Exploit</mark>
                </div>
                <ul class="project clearfix" id="main-word">
                    <li><h3>Programming</h3>
                        <p>一个不会编程的hacker不是好hacker，努力提高编码水平，接触最前沿的代码思想，构架自己的平台框架。</p>
                    </li>
                    <li><h3>Vulnerability</h3>
                        <p>没有漏洞就没有安全，安全建立在发现漏洞与解决漏洞之间。世上没有完美的代码，也不会有零漏洞的程序。</p>
                    </li>
                    <li><h3>Bypass</h3>
                        <p>不断地绕过，不断地突破防御机制，考验的是一个安全研究者对于漏洞原理的理解，更是猥琐的思路。</p>
                    </li>
                    <li><h3>Exploit</h3>
                        <p>发现一个漏洞，你成功了70%；写出利用代码，完成剩下的30%。行百步者半九十。</p>
                    </li>
                </ul>
            </div>
            <div class="col-6 columns" id="flash">
                <div class="panel-flash">
                    <a href="javascript:void(0)" class="stag stage3" style="display:block"><img src="/static/upload/images/03_1.jpg"
                                                                                                alt="deep"></a>
                    <a href="javascript:void(0)" class="stag stage1" style="display:none"><img src="/static/upload/images/01_1.jpg"
                                                                                               alt="about-me"></a>
                    <a href="javascript:void(0)" class="stag stage2" style="display:none"><img src="/static/upload/images/02_1.jpg"
                                                                                               alt="code"></a>
                </div>
            </div>
        </div>
    </div>
</div>


<div class="container">
    <div class="col-11 columns" id="mainbody">

        <div class="post type-post">
            <h2 class='loading-title' itemprop="name headline">
                <a itemtype="url" href="/SHARE/xray-introduce.html" title="XRay旅行记 - 从内部项目到社区项目的蜕变">XRay旅行记 -
                    从内部项目到社区项目的蜕变</a>
            </h2>

            <div class="details-up">
                <span class="author">作者: phithon</span>

                <span class="category">分类: <a href="/sort/SHARE">资源分享</a></span>

                <span class="date">时间: 2019-10-22 11:22</span>
                <span class="comments-top" itemprop="interactionCount">评论：<a itemprop="discussionUrl"
                                                                             href="/SHARE/xray-introduce.html#reply-list">4条评论</a></span>
                <span class="comments-top" itemprop="interactionCount">浏览：<a itemprop="discussionUrl"
                                                                             href="/SHARE/xray-introduce.html">3187人看过</a></span>

                <span class="date">标签:
    
        <a href="/tag/xray">xray</a>
    
  </span>

            </div>

            <div class="entry">

                <p>在上周六的攻必克，守必固——xray第二期线下技术沙龙上，我分享了一下我们xray开发团队做扫描器的想法和过程，包括一些解决的问题。</p>
                <p>预览PPT：</p>
                <p>[speakerdeck]2c1a7fa6a89845e7a0fe6f08f638777e|1.77777777777778[/speakerdeck]</p>
                <p>PPT直接下载：<a
                        href="https://vulhub.oss-cn-shanghai.aliyuncs.com/share/XRay%E6%97%85%E8%A1%8C%E8%AE%B0.pdf?spm=5176.8466032.0.dopenurl.637d14507VpYOx&amp;file=XRay%E6%97%85%E8%A1%8C%E8%AE%B0.pdf">XRay旅行记
                    - 从内部项目到社区项目的蜕变</a></p>
                <p>想参与我们xray的开发，包括研究一些与扫描器、WAF、HIDS、蜜罐相关内容的同学，可以看看我们的JD：</p>
                <blockquote>
                    <p>安全工程师（安全研究方向）<br/>
                        base北京</p>
                    <p>工作职责</p>
                    <p>1、跟进行业内的热点攻防思路；<br/>
                        2、研究甲方安全场景，研究不同甲方的实际安全需求；<br/>
                        3、为安全产品输出安全策略；<br/>
                        4、对外输出研究成果，建立技术影响力。</p>
                    <p>岗位要求<br/>
                        1、熟悉渗透测试思路，有渗透测试经验；<br/>
                        2、熟悉常见安全产品的对抗方法；<br/>
                        3、熟练掌握一门常见的脚本语言；<br/>
                    </p></blockquote>

            </div>
        </div>

        <div class="post type-post">
            <h2 class='loading-title' itemprop="name headline">
                <a itemtype="url" href="/PENETRATION/java-security-travel-6.html" title="Java安全漫谈 - 06.RMI篇(3)">Java安全漫谈
                    - 06.RMI篇(3)</a>
            </h2>

            <div class="details-up">
                <span class="author">作者: phithon</span>

                <span class="category">分类: <a href="/sort/PENETRATION">网络安全</a></span>

                <span class="date">时间: 2019-10-14 11:49</span>
                <span class="comments-top" itemprop="interactionCount">评论：<a itemprop="discussionUrl"
                                                                             href="/PENETRATION/java-security-travel-6.html#reply-list">0条评论</a></span>
                <span class="comments-top" itemprop="interactionCount">浏览：<a itemprop="discussionUrl"
                                                                             href="/PENETRATION/java-security-travel-6.html">3855人看过</a></span>

                <span class="date">标签:
    
        <a href="/tag/java%E5%AE%89%E5%85%A8">java安全</a>
    
  </span>

            </div>

            <div class="entry">

                这是一篇外部文章，点击 <a href="/PENETRATION/java-security-travel-6.html" target="_blank">链接跳转</a> 到文章地址……

            </div>
        </div>

        <div class="post type-post">
            <h2 class='loading-title' itemprop="name headline">
                <a itemtype="url" href="/PENETRATION/attack-scrapy.html" title="攻击Scrapyd爬虫">攻击Scrapyd爬虫</a>
            </h2>

            <div class="details-up">
                <span class="author">作者: phithon</span>

                <span class="category">分类: <a href="/sort/PENETRATION">网络安全</a></span>

                <span class="date">时间: 2019-9-18 11:49</span>
                <span class="comments-top" itemprop="interactionCount">评论：<a itemprop="discussionUrl"
                                                                             href="/PENETRATION/attack-scrapy.html#reply-list">5条评论</a></span>
                <span class="comments-top" itemprop="interactionCount">浏览：<a itemprop="discussionUrl"
                                                                             href="/PENETRATION/attack-scrapy.html">9353人看过</a></span>

                <span class="date">标签:
    
        <a href="/tag/scrapy">scrapy</a>
    
        <a href="/tag/%E7%88%AC%E8%99%AB">爬虫</a>
    
  </span>

            </div>

            <div class="entry">

                <p>类似我一贯的做法，这次Real World CTF我出了一道实战性的题目，目标仍然是getshell。</p>
                <p>我们以渗透测试的步骤来审视这道题目。</p>
                <h2 id="0x01"><a class="toclink" href="#0x01">0x01 信息搜集</a></h2>
                <p>与我以往的题目不同的是，这次虽然我自己写了一部分代码，但是这部分代码的目的是串联起几个服务，整个流程与代码漏洞无关，所以没有给出源代码。</p>
                <p>目标是一个简单的web，描述是“Use crawlbox to get all links from a page”，输入一个URL，稍等片刻可以获取这个页面里所有的链接，后端应该是一个爬虫：</p>
                <p><a href="/media/attachment/2019/09/18/41cb43ac-f5df-472b-9f6b-dc242848c2ec.png"><img alt="image.png"
                                                                                                        src="/static/upload/images/41cb43ac-f5df-472b-9f6b-dc242848c2ec.2ddb133f295a_1.png"/></a>
                </p>
                <p>我们抓取一下这个“爬虫”的请求：</p>
                <p><a href="/media/attachment/2019/09/18/98581daa-ea12-42c3-b6dc-d869db07960b.png"><img alt="image.png"
                                                                                                        src="/static/upload/images/98581daa-ea12-42c3-b6dc-d869db07960b.80f157fe2db5_1.png"/></a>
                </p>
                <p>可见其User-Agent是<code>Scrapy/ChromeHeadless (+https://scrapy.org)</code>。从其中获取到了两个信息：</p>
                <ul>
                    <li>Scrapy</li>
                    <li>Chrome Headless</li>
                </ul>
                <p>scrapy是python下的一款非常流行的爬虫框架，猜测用户输入的URL被</p>

            </div>
        </div>

        <div class="post type-post">
            <h2 class='loading-title' itemprop="name headline">
                <a itemtype="url" href="/PENETRATION/django-jsonfield-cve-2019-14234.html"
                   title="Django JSONField SQL注入漏洞（CVE-2019-14234）分析与影响">Django JSONField
                    SQL注入漏洞（CVE-2019-14234）分析与影响</a>
            </h2>

            <div class="details-up">
                <span class="author">作者: phithon</span>

                <span class="category">分类: <a href="/sort/PENETRATION">网络安全</a></span>

                <span class="date">时间: 2019-8-2 21:45</span>
                <span class="comments-top" itemprop="interactionCount">评论：<a itemprop="discussionUrl"
                                                                             href="/PENETRATION/django-jsonfield-cve-2019-14234.html#reply-list">6条评论</a></span>
                <span class="comments-top" itemprop="interactionCount">浏览：<a itemprop="discussionUrl"
                                                                             href="/PENETRATION/django-jsonfield-cve-2019-14234.html">17228人看过</a></span>

                <span class="date">标签:
    
        <a href="/tag/django">django</a>
    
        <a href="/tag/python%E5%AE%89%E5%85%A8">python安全</a>
    
  </span>

            </div>

            <div class="entry">

                <p>作为铁杆Django用户，发现昨天<a href="https://www.djangoproject.com/weblog/2019/aug/01/security-releases/">Django进行了更新</a>，且修复了一个SQL注入漏洞。在我印象里这应该是Django第一个SQL注入漏洞，且的确是可能在业务里出现的漏洞，于是进行了分析。
                </p>
                <h2 id="0x01-jsonfield"><a class="toclink" href="#0x01-jsonfield">0x01 什么是JSONField</a></h2>
                <p>
                    Django是一个大而全的Web框架，其支持很多数据库引擎，包括Postgresql、Mysql、Oracle、Sqlite3等，但与Django天生为一对儿的数据库莫过于Postgresql了，Django官方也建议配合Postgresql一起使用。</p>
                <p>相比于Mysql，Postgresql支持的数据类型更加丰富，其对JSON格式数据的支持也让这个关系型数据库拥有了NoSQL的一些特点。在Django中也支持了Postgresql的数据类型：</p>
                <ul>
                    <li>JSONField</li>
                    <li>ArrayField</li>
                    <li>HStoreField</li>
                </ul>
                <p>这三种数据类型因为都是非标量，且都能用JSON来表示，我下</p>

            </div>
        </div>

        <div class="post type-post">
            <h2 class='loading-title' itemprop="name headline">
                <a itemtype="url" href="/PENETRATION/when-imagemagick-meet-getimagesize.html"
                   title="imagemagick邂逅getimagesize的那点事儿">imagemagick邂逅getimagesize的那点事儿</a>
            </h2>

            <div class="details-up">
                <span class="author">作者: phithon</span>

                <span class="category">分类: <a href="/sort/PENETRATION">网络安全</a></span>

                <span class="date">时间: 2019-6-29 19:47</span>
                <span class="comments-top" itemprop="interactionCount">评论：<a itemprop="discussionUrl"
                                                                             href="/PENETRATION/when-imagemagick-meet-getimagesize.html#reply-list">0条评论</a></span>
                <span class="comments-top" itemprop="interactionCount">浏览：<a itemprop="discussionUrl"
                                                                             href="/PENETRATION/when-imagemagick-meet-getimagesize.html">17026人看过</a></span>

                <span class="date">标签:
    
        <a href="/tag/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1">代码审计</a>
    
  </span>

            </div>

            <div class="entry">

                <p>前段时间写的文章，在微博上说HW结束分享一下，总算可以发了。感谢 @voidfyoo 提出的这个问题。</p>
                <p>今天遇到一个代码，大致如下：</p>
                <div class="codehilite"><pre><span></span><span class="cp">&lt;?php</span>
<span class="nv">$filename</span> <span class="o">=</span> <span class="nv">$_FILES</span><span class="p">[</span><span
                            class="s1">&#39;image&#39;</span><span class="p">][</span><span class="s1">&#39;tmp_name&#39;</span><span
                            class="p">];</span>
<span class="nv">$size</span> <span class="o">=</span> <span class="nb">getimagesize</span><span class="p">(</span><span
                            class="nv">$filename</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="nv">$size</span> <span class="o">&amp;&amp;</span> <span
                            class="nv">$size</span><span class="p">[</span><span class="mi">0</span><span
                            class="p">]</span> <span class="o">&gt;</span> <span class="mi">100</span> <span class="o">&amp;&amp;</span> <span
                            class="nv">$size</span><span class="p">[</span><span class="mi">1</span><span
                            class="p">]</span> <span class="o">&gt;</span> <span class="mi">100</span><span
                            class="p">)</span> <span class="p">{</span>
    <span class="nv">$img</span> <span class="o">=</span> <span class="k">new</span> <span
                            class="nx">Imagick</span><span class="p">(</span><span class="nv">$_FILES</span><span
                            class="p">[</span><span class="s1">&#39;image&#39;</span><span class="p">][</span><span
                            class="s1">&#39;tmp_name&#39;</span><span class="p">]);</span>
    <span class="nv">$img</span><span class="o">-&gt;</span><span class="na">cropThumbnailImage</span><span
                            class="p">(</span><span class="mi">100</span><span class="p">,</span> <span
                            class="mi">100</span><span class="p">);</span>
    <span class="nv">$img</span><span class="o">-&gt;</span><span class="na">writeImage</span><span
                            class="p">(</span><span class="s1">&#39;newimage.gif&#39;</span><span class="p">);</span>
</pre>
                </div>

            </div>
        </div>

        <div class="post type-post">
            <h2 class='loading-title' itemprop="name headline">
                <a itemtype="url" href="/PENETRATION/code-breaking-2018-python-sandbox.html"
                   title="Code-Breaking中的两个Python沙箱">Code-Breaking中的两个Python沙箱</a>
            </h2>

            <div class="details-up">
                <span class="author">作者: phithon</span>

                <span class="category">分类: <a href="/sort/PENETRATION">网络安全</a></span>

                <span class="date">时间: 2019-5-27 10:57</span>
                <span class="comments-top" itemprop="interactionCount">评论：<a itemprop="discussionUrl"
                                                                             href="/PENETRATION/code-breaking-2018-python-sandbox.html#reply-list">4条评论</a></span>
                <span class="comments-top" itemprop="interactionCount">浏览：<a itemprop="discussionUrl"
                                                                             href="/PENETRATION/code-breaking-2018-python-sandbox.html">15643人看过</a></span>

                <span class="date">标签:
    
        <a href="/tag/code-breaking">code-breaking</a>
    
        <a href="/tag/python%E5%AE%89%E5%85%A8">python安全</a>
    
        <a href="/tag/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E">反序列化漏洞</a>
    
        <a href="/tag/ctf">ctf</a>
    
  </span>

            </div>

            <div class="entry">

                <p>这是发表在跳跳糖上的文章<a href="https://www.tttang.com/archive/1294/">https://www.tttang.com/archive/1294/</a>，如需转载，请联系跳跳糖。
                </p>
                <p>这是一篇Code-Breaking 2018鸽了半年的Writeup，讲一讲Django模板引擎沙箱和反序列化时的沙箱，和如何手搓Python picklecode绕过反序列化沙箱。</p>
                <p>源码与环境在这里：<a href="https://github.com/phith0n/code-breaking/blob/master/2018/picklecode">https://github.com/phith0n/code-breaking/blob/master/2018/picklecode</a>
                </p>
                <h2 id="django"><a class="toclink" href="#django">Django项目分析</a></h2>
                <p>首先下载源码，可以发现目标是一个Django项目。</p>
                <p>通常审计Django项目，我会先查看Django的配置文件。目标配置文件<code>code/settings.py</code>中有如下几个值得注意的地方：</p>
                <ul>
                    <li><code>SESSION_ENGINE = 'django.contrib.sessions.backends.signed_cooki</code></li>
                </ul>

            </div>
        </div>

        <div class="post type-post">
            <h2 class='loading-title' itemprop="name headline">
                <a itemtype="url" href="/PENETRATION/three-ipv6-url-tips.html" title="IPv6 三个访问本地地址的小Tips">IPv6
                    三个访问本地地址的小Tips</a>
            </h2>

            <div class="details-up">
                <span class="author">作者: phithon</span>

                <span class="category">分类: <a href="/sort/PENETRATION">网络安全</a></span>

                <span class="date">时间: 2019-5-25 17:58</span>
                <span class="comments-top" itemprop="interactionCount">评论：<a itemprop="discussionUrl"
                                                                             href="/PENETRATION/three-ipv6-url-tips.html#reply-list">0条评论</a></span>
                <span class="comments-top" itemprop="interactionCount">浏览：<a itemprop="discussionUrl"
                                                                             href="/PENETRATION/three-ipv6-url-tips.html">20418人看过</a></span>

                <span class="date">标签:
    
        <a href="/tag/ipv6">ipv6</a>
    
  </span>

            </div>

            <div class="entry">

                <p>最近发现家里宽带支持IPv6了，这里分享三个利用IPv6访问本地地址（内网地址）的方法。</p>
                <p>通常来说，我们用localhost来代表本地地址<code>127.0.0.1</code>。其实在IPv6中有他自己的表示方法<code>ip6-localhost</code>：</p>
                <p><a href="/media/attachment/2019/06/26/08473e83-55eb-4d61-9c26-b0ada6715496.png"><img alt="image.png"
                                                                                                        src="/static/upload/images/08473e83-55eb-4d61-9c26-b0ada6715496.b23814d0030f_1.png"/></a>
                </p>
                <p>另外，大家应该都知道xip.io这个服务，可以将任何IP地址用域名的形式表示，用来测试SSRF漏洞比较方便。但xip.io只支持IPv4，IPv6下也有个类似的服务，ip6.name。</p>
                <p>比如，我们可以通过<code>x.1.ip6.name</code>访问<code>::1</code>，也就是本地：</p>
                <p><a href="/media/attachment/2019/06/26/18c370d5-c8b7-47af-9cbd-e1a09aa409ba.png"><img alt="image.png"
                                                                                                        src="/static/upload/images/18c370d5-c8b7-47af-9cbd-e1a09aa409ba.abf4ac33492d_1.png"/></a>
                </p>
                <p>再分享一个Windows下有趣的冷知识吧。</p>
                <p>UNC Path是Windows中访问共享资源的方法，前段时间代码审计圈子里还分享过PHP利用UNC、WebDAV来包含远程文件的方法：<a
                        href="https://t.zsxq.com/fUjiMfY">https://t.zsxq.com/fUjiMfY</a></p>
                <p>而UNC Path是不支持冒号的，所以我们没法在UNC Path中使用IPv6地址：<code>\</code></p>

            </div>
        </div>

        <div class="post type-post">
            <h2 class='loading-title' itemprop="name headline">
                <a itemtype="url" href="/PENETRATION/javascript-prototype-pollution-attack.html"
                   title="深入理解 JavaScript Prototype 污染攻击">深入理解 JavaScript Prototype 污染攻击</a>
            </h2>

            <div class="details-up">
                <span class="author">作者: phithon</span>

                <span class="category">分类: <a href="/sort/PENETRATION">网络安全</a></span>

                <span class="date">时间: 2019-4-3 0:15</span>
                <span class="comments-top" itemprop="interactionCount">评论：<a itemprop="discussionUrl"
                                                                             href="/PENETRATION/javascript-prototype-pollution-attack.html#reply-list">21条评论</a></span>
                <span class="comments-top" itemprop="interactionCount">浏览：<a itemprop="discussionUrl"
                                                                             href="/PENETRATION/javascript-prototype-pollution-attack.html">22637人看过</a></span>

                <span class="date">标签:
    
        <a href="/tag/%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93">原型链污染</a>
    
        <a href="/tag/javascript">javascript</a>
    
  </span>

            </div>

            <div class="entry">

                <p>本来是想发在<a href="https://zsxq.tricking.io/landpage/">代码审计知识星球</a>里的一篇科普文章，因为最近知识星球似乎在和神秘组织对接，无法发表内容，所以发在博客里。Code-Breaking官方writeup拖了很久，主要是没时间，不过外面已经有很多同学的writeup了，所以问题不大。
                </p>
                <p>
                    JavaScript是一门非常灵活的语言，我感觉在某些方面可能比PHP更加灵活。所以，除了传统的SQL注入、代码执行等注入型漏洞外，也会有一些独有的安全问题，比如今天要说这个prototype污染。</p>
                <h2 id="0x01-prototype__proto__"><a class="toclink" href="#0x01-prototype__proto__">0x01
                    <code>prototype</code>和<code>__proto__</code>分别是什么？</a></h2>
                <p>JavaScript中，我们如果要定义一个类，需要以定义“构造函数”的方式来定义：</p>
                <div class="codehilite"><pre><span></span><span class="kd">function</span> <span
                        class="nx">Foo</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">bar</span> <span class="o">=</span> <span
                            class="mi">1</span>
<span class="p">}</span>

<span class="k">new</span> <span class="nx">Foo</span><span class="p">()</span>
</pre>
                </div>


                <p><code>Foo</code>函数的内容，就是<code>Foo</code>类的构造函数，而<code>this.bar</code>就是<code>Foo</code>类的一个属性。</p>
                <blockquote>
                    <p>为了简化编写JavaScr</p></blockquote>

            </div>
        </div>

        <div class="post type-post">
            <h2 class='loading-title' itemprop="name headline">
                <a itemtype="url" href="/PENETRATION/use-pcre-backtrack-limit-to-bypass-restrict.html"
                   title="PHP利用PCRE回溯次数限制绕过某些安全限制">PHP利用PCRE回溯次数限制绕过某些安全限制</a>
            </h2>

            <div class="details-up">
                <span class="author">作者: phithon</span>

                <span class="category">分类: <a href="/sort/PENETRATION">网络安全</a></span>

                <span class="date">时间: 2018-11-26 0:33</span>
                <span class="comments-top" itemprop="interactionCount">评论：<a itemprop="discussionUrl"
                                                                             href="/PENETRATION/use-pcre-backtrack-limit-to-bypass-restrict.html#reply-list">27条评论</a></span>
                <span class="comments-top" itemprop="interactionCount">浏览：<a itemprop="discussionUrl"
                                                                             href="/PENETRATION/use-pcre-backtrack-limit-to-bypass-restrict.html">44364人看过</a></span>

                <span class="date">标签:
    
        <a href="/tag/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F">正则表达式</a>
    
  </span>

            </div>

            <div class="entry">

                <p>这次Code-Breaking Puzzles中我出了一道看似很简单的题目<a href="https://code-breaking.com/puzzle/2/">pcrewaf</a>，将其代码简化如下：
                </p>
                <div class="codehilite"><pre><span></span><span class="cp">&lt;?php</span>
<span class="k">function</span> <span class="nf">is_php</span><span class="p">(</span><span class="nv">$data</span><span
                            class="p">){</span>
    <span class="k">return</span> <span class="nb">preg_match</span><span class="p">(</span><span class="s1">&#39;/&lt;\?.*[(`;?&gt;].*/is&#39;</span><span
                            class="p">,</span> <span class="nv">$data</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">is_php</span><span
                            class="p">(</span><span class="nv">$input</span><span class="p">))</span> <span
                            class="p">{</span>
    <span class="c1">// fwrite($f, $input); ...</span>
<span class="p">}</span>
</pre>
                </div>


                <p>大意是判断一下用户输入的内容有没有PHP代码，如果没有，则写入文件。这种时候，如何绕过<code>is_php()</code>函数来写入webshell呢？</p>
                <p>这道题看似简单，深究其原理，还是值得写一篇文章的。</p>
                <h2 id="0x01"><a class="toclink" href="#0x01">0x01 正则表达式是什么</a></h2>
                <p>正则表达式是一个可以被“有限状态自动机”接受的语言类。</p>
                <p>“有限状态自动机”，其拥有有限数量的状态，每个状态可以迁移到零个或多个状态，输入字串决定执行</p>

            </div>
        </div>

        <div class="post type-post">
            <h2 class='loading-title' itemprop="name headline">
                <a itemtype="url" href="/PENETRATION/code-breaking-puzzles.html"
                   title="代码审计知识星球二周年 &amp;&amp; Code-Breaking Puzzles">代码审计知识星球二周年 &amp;&amp; Code-Breaking Puzzles</a>
            </h2>

            <div class="details-up">
                <span class="author">作者: phithon</span>

                <span class="category">分类: <a href="/sort/PENETRATION">网络安全</a></span>

                <span class="date">时间: 2018-11-24 19:24</span>
                <span class="comments-top" itemprop="interactionCount">评论：<a itemprop="discussionUrl"
                                                                             href="/PENETRATION/code-breaking-puzzles.html#reply-list">3条评论</a></span>
                <span class="comments-top" itemprop="interactionCount">浏览：<a itemprop="discussionUrl"
                                                                             href="/PENETRATION/code-breaking-puzzles.html">35919人看过</a></span>

                <span class="date">标签:
    
        <a href="/tag/code-breaking">code-breaking</a>
    
        <a href="/tag/%E7%9F%A5%E8%AF%86%E6%98%9F%E7%90%83">知识星球</a>
    
        <a href="/tag/ctf">ctf</a>
    
  </span>

            </div>

            <div class="entry">

                <p>地址：<a href="https://code-breaking.com">https://code-breaking.com</a></p>
                <p>Code-Breaking Puzzles 是一场完全开放源代码的Web解密游戏，其包含但不限于PHP、Java、Node.js、Python等语言的代码审计知识。</p>
                <p>从昨天晚上7点开始到现在已经一天了，9到题里面也有6道已经有人解出。</p>
                <p>列出每个题目的知识点，可以辅助大家更快找到解题方法：</p>
                <ol>
                    <li>function PHP函数利用技巧</li>
                    <li>pcrewaf PHP正则特性</li>
                    <li>phpmagic PHP写文件技巧</li>
                    <li>phplimit PHP代码执行限制绕过</li>
                    <li>nodechr Javascript字符串特性</li>
                    <li>javacon SPEL表达式沙盒绕过</li>
                    <li>lumenserial 反序列化在7.2下的利用</li>
                    <li>picklecode Python反序列化沙盒绕过</li>
                    <li>thejs Javascript对象特性利用</li>
                </ol>
                <p>几乎每个题都有1~2个非常有意思的特性与知识点，有时间的同学可以</p>

            </div>
        </div>


    </div>


    <div class="col-5 columns" id="sidebar" role="complementary">

        <div class="widget widget_search">
            <h3>搜索</h3>
            <form action="/search/" id="searchform" method="get">
                <input type="text" id="searchkey" name="keyword" value="" class="searchkey" placeholder="Search..."/>
                <button type="submit" id="searchsubmit">Go</button>
            </form>
        </div>


        <div class="widget">
            <h3 class="widget-title">最新评论</h3>
            <ul class="widget-list" id="recent-comment">


                <li id="comment" class="clearfix">
                    <img class="avatar" src="/static/upload/images/bf58432148b643a8b4c41c3901b81d1b_1.jpg" alt="%s" width="40"
                         height="40">
                    <div class="comments-link"><cite>test</cite>：<a href="/SHARE/xray-introduce.html#comment-3435">谢谢大佬分享</a>
                    </div>
                </li>

                <li id="comment" class="clearfix">
                    <img class="avatar" src="/static/upload/images/d41d8cd98f00b204e9800998ecf8427e_1.jpg" alt="%s" width="40"
                         height="40">
                    <div class="comments-link"><cite>test</cite>：<a
                            href="/SHARE/xray-introduce.html#comment-3429">上PPT了</a></div>
                </li>

                <li id="comment" class="clearfix">
                    <img class="avatar" src="/static/upload/images/d41d8cd98f00b204e9800998ecf8427e_1.jpg" alt="%s" width="40"
                         height="40">
                    <div class="comments-link"><cite>tset</cite>：<a href="/SHARE/xray-introduce.html#comment-3430">@test
                        代大佬牛批</a></div>
                </li>

                <li id="comment" class="clearfix">
                    <img class="avatar" src="/static/upload/images/d41d8cd98f00b204e9800998ecf8427e_1.jpg" alt="%s" width="40"
                         height="40">
                    <div class="comments-link"><cite>Demons</cite>：<a href="/SHARE/xray-introduce.html#comment-3431">@tset
                        代大佬牛逼</a></div>
                </li>

                <li id="comment" class="clearfix">
                    <img class="avatar" src="/static/upload/images/d41d8cd98f00b204e9800998ecf8427e_1.jpg" alt="%s" width="40"
                         height="40">
                    <div class="comments-link"><cite>redcon</cite>：<a
                            href="/PENETRATION/attack-scrapy.html#comment-3424">go0st 不更新了吗？ 最近在研究这个 萌新</a></div>
                </li>

            </ul>
        </div>

        <div class="widget widget-category">
            <h3>分类</h3>
            <ul id="blogsort" class="widget-list">


                <li>
                    <a href="/sort/PENETRATION">网络安全<em>121</em></a>
                </li>

                <li>
                    <a href="/sort/C">C/C++<em>32</em></a>
                </li>

                <li>
                    <a href="/sort/PYTHON">Python<em>18</em></a>
                </li>

                <li>
                    <a href="/sort/SHARE">资源分享<em>16</em></a>
                </li>

                <li>
                    <a href="/sort/HTML">web前端<em>13</em></a>
                </li>

            </ul>
        </div>

        <div class="widget widget-tag">
            <h3>随机标签</h3>
            <div class="tag-cloud">


                <a rel="tag" href="/tag/%E5%BE%AA%E7%8E%AF%E9%93%BE%E8%A1%A8">循环链表</a>

                <a rel="tag" href="/tag/string">string</a>

                <a rel="tag" href="/tag/asp">asp</a>

                <a rel="tag" href="/tag/%E8%87%AA%E5%8A%A8%E8%AE%BE%E7%BD%AE">自动设置</a>

                <a rel="tag" href="/tag/brainfuck">brainfuck</a>

                <a rel="tag" href="/tag/java">java</a>

                <a rel="tag" href="/tag/mssql">mssql</a>

                <a rel="tag" href="/tag/fineCMS">fineCMS</a>

                <a rel="tag" href="/tag/Jquery">Jquery</a>

                <a rel="tag" href="/tag/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E">命令执行漏洞</a>

                <a rel="tag" href="/tag/%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91">端口转发</a>

                <a rel="tag" href="/tag/%E9%94%AE%E7%9B%98%E8%AE%B0%E5%BD%95">键盘记录</a>

                <a rel="tag" href="/tag/webshell">webshell</a>

                <a rel="tag" href="/tag/ssrf%E6%BC%8F%E6%B4%9E">ssrf漏洞</a>

                <a rel="tag" href="/tag/%E5%8A%A0%E5%AF%86">加密</a>

                <a rel="tag" href="/tag/WAF">WAF</a>

                <a rel="tag" href="/tag/%E6%88%90%E9%95%BF">成长</a>

                <a rel="tag" href="/tag/VC++">VC++</a>

                <a rel="tag" href="/tag/%E5%B9%B3%E8%A1%A1%E6%9D%83%E9%99%90">平衡权限</a>

                <a rel="tag" href="/tag/%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C">文件操作</a>

                <a rel="tag" href="/tag/%E6%9D%83%E9%87%8D">权重</a>

                <a rel="tag" href="/tag/web%E6%8C%87%E7%BA%B9">web指纹</a>

                <a rel="tag" href="/tag/gitea">gitea</a>

                <a rel="tag" href="/tag/emlog%E6%8F%92%E4%BB%B6">emlog插件</a>

                <a rel="tag" href="/tag/%E9%80%BB%E8%BE%91%E6%BC%8F%E6%B4%9E">逻辑漏洞</a>

                <a rel="tag" href="/tag/_countof">_countof</a>

                <a rel="tag" href="/tag/sprintf">sprintf</a>

                <a rel="tag" href="/tag/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1">代码审计</a>

                <a rel="tag" href="/tag/pwnhub">pwnhub</a>

                <a rel="tag" href="/tag/php7">php7</a>

            </div>
        </div>

        <div class="widget widget-recent-entries">
            <h3 class="widget-title">热门日志</h3>
            <ul id="hotlog" class="widget-list">


                <li><a href="/other/tinger.html">About.Me</a></li>

                <li><a href="/PHP/phpdelfile.html">php遍历目录&amp;删除指定文件中指定内容</a></li>

                <li><a href="/THINK/banjia.html">博客搬家成功</a></li>

                <li><a href="/PENETRATION/apache-cve-2017-15715-vulnerability.html">利用最新Apache解析漏洞（CVE-2017-15715）绕过上传黑名单</a>
                </li>

                <li><a href="/C/CGIforC_1.html">C语言CGI编程入门(一)</a></li>

            </ul>
        </div>


    </div>
</div>

<div id="footer">
    <!-- copyright -->
    <div class="container">
        <div class="row remove-bottom">
            <div class="col-6 columns">
                <h3>Little About</h3>
                <p>Phithon 非强迫症小青年 <br>
                    现居先 <br>
                    爱好：种花、买书、收藏明信片 <br>
                    欢迎各大组织收留 <br>
                    E-mail：root@leavesongs.com </p>
            </div>

            <div class="col-10 columns">

                <h3 class="mobile-hide">Follow me</h3>
                <div id="social-links">
                    <a href="http://weibo.com/101yx" class="sweibo" target="_blank" title="新浪微博">新浪微博</a>
                    <a href="javascript:alert(/没有腾讯微博哟/)" class="qweibo" target="_blank" title="腾讯微博">腾讯微博</a>
                    <a href="javascript:alert(/墙外有什么/);window.open('http://google.com')" class="google" target="_blank"
                       title="墙外的世界">google+</a>
                    <a href="https://github.com/phith0n" class="github" target="_blank" title="Github">github</a>
                    <a href="javascript:confirm(/mailto:root#leavesongs.com/)" class="mail" target="_blank"
                       title="私信给我">私信给我</a>
                    <a href="/feed/" target="_blank" class="rss" title="离别歌">RSS订阅</a>
                </div>
                <div class="bot-line"></div>
                <p class="copyright">
                    Copyright &copy; Powered by talkbook
                    &nbsp;&nbsp;<i>Designed and built with all the love in the world by <a
                        href="https://www.leavesongs.com" target="_blank">Phithon</a> && deepsky </i>
                    <a href="/template/change/">更换模板</a>
                </p>
            </div>
        </div>
    </div>
    <!-- /copyright -->
</div>
<a href="#" id="go-top">Top ↑</a>
<script src="{% static 'home/js/jquery.appear_1.js' %}"></script>
<script src="{% static 'home/js/config_1.js' %}"></script>
<script>
    var _hmt = _hmt || [];
    (function () {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?ad9ab5e37c2811b9f0979e46123fc898";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
    })();
</script>

</body>

</html>